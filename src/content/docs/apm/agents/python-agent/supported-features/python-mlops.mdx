---
title: Python and Machine Learning
tags:
  - Agents
  - Python agent
redirects:
  - /docs/agents/python-agent/supported-features/python-mlops
---

import allEntities from 'images/python-ml-APM-All-Entities.png'
import modelsView from 'images/python-ml-APM-models-view.png'
import modelSummary1 from 'images/python-ml-APM-model-summary-view1.png'
import modelSummary2 from 'images/python-ml-APM-model-summary-view2.png'

New Relic now enables monitoring for Machine Learning Models.  These monitored ML models can be found in the APM in the Models section.

## Setup

<Callout variant="tip">
  ML model metrics are available for Python agent version 9.1.0 and higher but are disabled by default. To change this configuration, check out our [documentation](/docs/apm/agents/python-agent/configuration/python-agent-configuration#ml-settings).
</Callout>

To change the default ML harvest size of 100000 every 5 seconds, either set `event_harvest_config.harvest_limits.ml_event_data` in your newrelic.ini file to the desired value or set the environment variable `NEW_RELIC_ML_INSIGHTS_EVENTS_MAX_SAMPLES_STORED` to the desired value:

```bash
export NEW_RELIC_ML_INSIGHTS_EVENTS_MAX_SAMPLES_STORED=${desired_value}
```

## Currently Instrumented Machine Learning Frameworks

<table>
  <thead>
    <tr>
      <th>
        **ML Library**
      </th>

      <th>
        **Version Available**
      </th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>
        [scikit learn](https://pypi.org/project/scikit-learn/)
      </td>

      <td>
        10.0.0
      </td>
    </tr>
  </tbody>
</table>


## Machine Learning APIs

Two new APIs exist to customize the ML instrumentation experience:

<ul>
  <li>Record custom ML events: (record_ml_event)[/docs/agents/python-agent/python-agent-api/recordmlevent-python-agent-api]</li>
  <li>Manually instrument an ML model: (wrap_mlmodel)[/docs/agents/python-agent/python-agent-api/wrapmlmodel-python-agent-api]</li>
</ul>


## Features and Functionality

Models can be seen in a separate Models category in the All Entries view:

<img
  title="python-ml-APM-All-Entities.png"
  alt="Screen capture showing ML Models in APM All Entries view."
  src={allEntities}
/>

A summary of models in the Models view:

<img
  title="python-ml-APM-models-view.png"
  alt="Screen capture showing ML Models in APM Models view."
  src={modelsView}
/>

Within the model summary, an overall model performance view can be seen as well as a Prediction Distribution.

<img
  title="python-ml-APM-model-summary-view1.png"
  alt="Screen capture showing Label Propagation ML Model Summary view."
  src={modelSummary1}
/>

<img
  title="python-ml-APM-model-summary-view2.png"
  alt="Screen capture showing Label Propagation ML Model Summary view."
  src={modelSummary2}
/>


